{"version":3,"file":"complete-payment.js","names":["successResponse","errorResponse","Stripe","stripe","confirmPaymentIntent","req","res","paymentIntentId","body","paymentIntent","paymentIntents","confirm","status","clientSecret","client_secret","json","requiresAction","success","error","console","message"],"sources":["../../src/controllers/complete-payment.js"],"sourcesContent":["import { successResponse, errorResponse } from \"../utils/response.js\";\nimport Stripe from 'stripe';\n\nconst stripe = new Stripe(\"sk_test_51OHMnlSD010bwSLtbxEWBTJYuThpDaWOA6vi3tf7nfBsu6fAVy7magTCmrrw1KNFXLD6k4cGuW6BGly0e8Y4mlfF00yNKUnfCv\");\n\nexport const confirmPaymentIntent = async (req, res) => {\n    const { paymentIntentId } = req.body;\n\n    try {\n        const paymentIntent = await stripe.paymentIntents.confirm(paymentIntentId);\n\n        if (paymentIntent.status === 'requires_action') {\n            const clientSecret = paymentIntent.client_secret;\n\n            res.status(200).json({ requiresAction: true, clientSecret });\n        } else if (paymentIntent.status === 'succeeded') {\n            res.status(200).json({ success: true });\n        } else {\n            res.status(400).json({ error: 'Unexpected PaymentIntent status' });\n        }\n    } catch (error) {\n        console.error('Error confirming PaymentIntent:', error.message);\n        res.status(500).json({ error: error.message });\n    }\n};"],"mappings":"AAAA,SAASA,eAAe,EAAEC,aAAa,QAAQ,sBAAsB;AACrE,OAAOC,MAAM,MAAM,QAAQ;AAE3B,MAAMC,MAAM,GAAG,IAAID,MAAM,CAAC,6GAA6G,CAAC;AAExI,OAAO,MAAME,oBAAoB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,KAAK;EACpD,MAAM;IAAEC;EAAgB,CAAC,GAAGF,GAAG,CAACG,IAAI;EAEpC,IAAI;IACA,MAAMC,aAAa,GAAG,MAAMN,MAAM,CAACO,cAAc,CAACC,OAAO,CAACJ,eAAe,CAAC;IAE1E,IAAIE,aAAa,CAACG,MAAM,KAAK,iBAAiB,EAAE;MAC5C,MAAMC,YAAY,GAAGJ,aAAa,CAACK,aAAa;MAEhDR,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACG,IAAI,CAAC;QAAEC,cAAc,EAAE,IAAI;QAAEH;MAAa,CAAC,CAAC;IAChE,CAAC,MAAM,IAAIJ,aAAa,CAACG,MAAM,KAAK,WAAW,EAAE;MAC7CN,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACG,IAAI,CAAC;QAAEE,OAAO,EAAE;MAAK,CAAC,CAAC;IAC3C,CAAC,MAAM;MACHX,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACG,IAAI,CAAC;QAAEG,KAAK,EAAE;MAAkC,CAAC,CAAC;IACtE;EACJ,CAAC,CAAC,OAAOA,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAACE,OAAO,CAAC;IAC/Dd,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACG,IAAI,CAAC;MAAEG,KAAK,EAAEA,KAAK,CAACE;IAAQ,CAAC,CAAC;EAClD;AACJ,CAAC"}