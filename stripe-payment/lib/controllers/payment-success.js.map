{"version":3,"file":"payment-success.js","names":["successResponse","errorResponse","Stripe","stripe","paymentSuccess","req","res","session_id","query","session","checkout","sessions","retrieve","payment_status","error","message"],"sources":["../../src/controllers/payment-success.js"],"sourcesContent":["import { successResponse, errorResponse } from \"../utils/response.js\";\nimport Stripe from 'stripe';\n\nconst stripe = new Stripe(\"sk_test_51OHMnlSD010bwSLtbxEWBTJYuThpDaWOA6vi3tf7nfBsu6fAVy7magTCmrrw1KNFXLD6k4cGuW6BGly0e8Y4mlfF00yNKUnfCv\");\n\nexport const paymentSuccess = async (req, res) => {\n    const session_id = req.query.session_id;\n    try {\n        const session = await stripe.checkout.sessions.retrieve(session_id);\n\n        if (session.payment_status === \"paid\") {\n            return successResponse(res, 200, \"Payment successful\", session);\n        } else {\n            return errorResponse(res, 400, \"Payment not completed yet\", session);\n        }\n    } catch (error) {\n        return errorResponse(res, 500, \"Failed to retrieve session\", { error: error.message });\n    }\n};"],"mappings":"AAAA,SAASA,eAAe,EAAEC,aAAa,QAAQ,sBAAsB;AACrE,OAAOC,MAAM,MAAM,QAAQ;AAE3B,MAAMC,MAAM,GAAG,IAAID,MAAM,CAAC,6GAA6G,CAAC;AAExI,OAAO,MAAME,cAAc,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,KAAK;EAC9C,MAAMC,UAAU,GAAGF,GAAG,CAACG,KAAK,CAACD,UAAU;EACvC,IAAI;IACA,MAAME,OAAO,GAAG,MAAMN,MAAM,CAACO,QAAQ,CAACC,QAAQ,CAACC,QAAQ,CAACL,UAAU,CAAC;IAEnE,IAAIE,OAAO,CAACI,cAAc,KAAK,MAAM,EAAE;MACnC,OAAOb,eAAe,CAACM,GAAG,EAAE,GAAG,EAAE,oBAAoB,EAAEG,OAAO,CAAC;IACnE,CAAC,MAAM;MACH,OAAOR,aAAa,CAACK,GAAG,EAAE,GAAG,EAAE,2BAA2B,EAAEG,OAAO,CAAC;IACxE;EACJ,CAAC,CAAC,OAAOK,KAAK,EAAE;IACZ,OAAOb,aAAa,CAACK,GAAG,EAAE,GAAG,EAAE,4BAA4B,EAAE;MAAEQ,KAAK,EAAEA,KAAK,CAACC;IAAQ,CAAC,CAAC;EAC1F;AACJ,CAAC"}